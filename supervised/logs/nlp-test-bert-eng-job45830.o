Model is on device: cuda:0
Map:   0%|          | 0/801 [00:00<?, ? examples/s]Map: 100%|██████████| 801/801 [01:38<00:00,  8.13 examples/s]Map: 100%|██████████| 801/801 [01:38<00:00,  8.13 examples/s]
Map:   0%|          | 0/4004 [00:00<?, ? examples/s]Map:  25%|██▍       | 1000/4004 [01:27<04:23, 11.39 examples/s]Map:  25%|██▍       | 1000/4004 [01:39<04:23, 11.39 examples/s]Map:  50%|████▉     | 2000/4004 [01:58<01:48, 18.54 examples/s]Map:  50%|████▉     | 2000/4004 [02:09<01:48, 18.54 examples/s]Map:  75%|███████▍  | 3000/4004 [03:01<00:58, 17.10 examples/s]Map:  75%|███████▍  | 3000/4004 [03:19<00:58, 17.10 examples/s]Map: 100%|█████████▉| 4000/4004 [03:32<00:00, 21.11 examples/s]Map: 100%|██████████| 4004/4004 [03:32<00:00, 21.09 examples/s]Map: 100%|██████████| 4004/4004 [03:32<00:00, 18.84 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
/lab/haoq_lab/cse12210736/.conda/envs/nlp/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
  0%|          | 0/26 [00:00<?, ?it/s]  8%|▊         | 2/26 [00:00<00:02, 11.32it/s] 15%|█▌        | 4/26 [00:00<00:03,  7.09it/s] 19%|█▉        | 5/26 [00:00<00:03,  6.60it/s] 23%|██▎       | 6/26 [00:00<00:03,  6.29it/s] 27%|██▋       | 7/26 [00:01<00:03,  6.09it/s] 31%|███       | 8/26 [00:01<00:03,  5.95it/s] 35%|███▍      | 9/26 [00:01<00:02,  5.86it/s] 38%|███▊      | 10/26 [00:01<00:02,  5.79it/s] 42%|████▏     | 11/26 [00:01<00:02,  5.74it/s] 46%|████▌     | 12/26 [00:01<00:02,  5.71it/s] 50%|█████     | 13/26 [00:02<00:02,  5.70it/s] 54%|█████▍    | 14/26 [00:02<00:02,  5.68it/s] 58%|█████▊    | 15/26 [00:02<00:01,  5.66it/s] 62%|██████▏   | 16/26 [00:02<00:01,  5.65it/s] 65%|██████▌   | 17/26 [00:02<00:01,  5.64it/s] 69%|██████▉   | 18/26 [00:03<00:01,  5.62it/s] 73%|███████▎  | 19/26 [00:03<00:01,  5.62it/s] 77%|███████▋  | 20/26 [00:03<00:01,  5.61it/s] 81%|████████  | 21/26 [00:03<00:00,  5.62it/s] 85%|████████▍ | 22/26 [00:03<00:00,  5.62it/s] 88%|████████▊ | 23/26 [00:03<00:00,  5.62it/s] 92%|█████████▏| 24/26 [00:04<00:00,  5.61it/s] 96%|█████████▌| 25/26 [00:04<00:00,  5.61it/s]100%|██████████| 26/26 [00:04<00:00,  6.01it/s]
/lab/haoq_lab/cse12210736/.conda/envs/nlp/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:71: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn(
In-domain (essay validation) results: {'accuracy': 0.8539325842696629, 'precision': 0.8582278481012658, 'recall': 0.8475, 'f1': 0.8528301886792453, 'auroc': np.float64(0.9297069825436409)}
  0%|          | 0/126 [00:00<?, ?it/s]  2%|▏         | 2/126 [00:00<00:11, 11.24it/s]  3%|▎         | 4/126 [00:00<00:17,  7.05it/s]  4%|▍         | 5/126 [00:00<00:18,  6.55it/s]  5%|▍         | 6/126 [00:00<00:19,  6.23it/s]  6%|▌         | 7/126 [00:01<00:19,  6.03it/s]  6%|▋         | 8/126 [00:01<00:20,  5.90it/s]  7%|▋         | 9/126 [00:01<00:20,  5.80it/s]  8%|▊         | 10/126 [00:01<00:20,  5.73it/s]  9%|▊         | 11/126 [00:01<00:20,  5.67it/s] 10%|▉         | 12/126 [00:01<00:20,  5.62it/s] 10%|█         | 13/126 [00:02<00:20,  5.61it/s] 11%|█         | 14/126 [00:02<00:19,  5.61it/s] 12%|█▏        | 15/126 [00:02<00:19,  5.61it/s] 13%|█▎        | 16/126 [00:02<00:19,  5.60it/s] 13%|█▎        | 17/126 [00:02<00:19,  5.60it/s] 14%|█▍        | 18/126 [00:03<00:19,  5.59it/s] 15%|█▌        | 19/126 [00:03<00:19,  5.59it/s] 16%|█▌        | 20/126 [00:03<00:18,  5.58it/s] 17%|█▋        | 21/126 [00:03<00:18,  5.58it/s] 17%|█▋        | 22/126 [00:03<00:18,  5.58it/s] 18%|█▊        | 23/126 [00:03<00:18,  5.58it/s] 19%|█▉        | 24/126 [00:04<00:18,  5.57it/s] 20%|█▉        | 25/126 [00:04<00:18,  5.57it/s] 21%|██        | 26/126 [00:04<00:17,  5.57it/s] 21%|██▏       | 27/126 [00:04<00:17,  5.57it/s] 22%|██▏       | 28/126 [00:04<00:17,  5.57it/s] 23%|██▎       | 29/126 [00:05<00:17,  5.58it/s] 24%|██▍       | 30/126 [00:05<00:17,  5.57it/s] 25%|██▍       | 31/126 [00:05<00:17,  5.56it/s] 25%|██▌       | 32/126 [00:05<00:16,  5.56it/s] 26%|██▌       | 33/126 [00:05<00:16,  5.56it/s] 27%|██▋       | 34/126 [00:05<00:16,  5.56it/s] 28%|██▊       | 35/126 [00:06<00:16,  5.56it/s] 29%|██▊       | 36/126 [00:06<00:16,  5.57it/s] 29%|██▉       | 37/126 [00:06<00:15,  5.57it/s] 30%|███       | 38/126 [00:06<00:15,  5.57it/s] 31%|███       | 39/126 [00:06<00:15,  5.57it/s] 32%|███▏      | 40/126 [00:06<00:15,  5.56it/s] 33%|███▎      | 41/126 [00:07<00:15,  5.57it/s] 33%|███▎      | 42/126 [00:07<00:15,  5.56it/s] 34%|███▍      | 43/126 [00:07<00:14,  5.56it/s] 35%|███▍      | 44/126 [00:07<00:14,  5.55it/s] 36%|███▌      | 45/126 [00:07<00:14,  5.54it/s] 37%|███▋      | 46/126 [00:08<00:14,  5.54it/s] 37%|███▋      | 47/126 [00:08<00:14,  5.54it/s] 38%|███▊      | 48/126 [00:08<00:14,  5.54it/s] 39%|███▉      | 49/126 [00:08<00:13,  5.53it/s] 40%|███▉      | 50/126 [00:08<00:13,  5.52it/s] 40%|████      | 51/126 [00:08<00:13,  5.53it/s] 41%|████▏     | 52/126 [00:09<00:13,  5.53it/s] 42%|████▏     | 53/126 [00:09<00:13,  5.53it/s] 43%|████▎     | 54/126 [00:09<00:13,  5.53it/s] 44%|████▎     | 55/126 [00:09<00:12,  5.53it/s] 44%|████▍     | 56/126 [00:09<00:12,  5.53it/s] 45%|████▌     | 57/126 [00:10<00:12,  5.51it/s] 46%|████▌     | 58/126 [00:10<00:12,  5.53it/s] 47%|████▋     | 59/126 [00:10<00:12,  5.54it/s] 48%|████▊     | 60/126 [00:10<00:11,  5.55it/s] 48%|████▊     | 61/126 [00:10<00:11,  5.55it/s] 49%|████▉     | 62/126 [00:10<00:11,  5.55it/s] 50%|█████     | 63/126 [00:11<00:11,  5.55it/s] 51%|█████     | 64/126 [00:11<00:11,  5.55it/s] 52%|█████▏    | 65/126 [00:11<00:11,  5.54it/s] 52%|█████▏    | 66/126 [00:11<00:10,  5.54it/s] 53%|█████▎    | 67/126 [00:11<00:10,  5.53it/s] 54%|█████▍    | 68/126 [00:12<00:10,  5.51it/s] 55%|█████▍    | 69/126 [00:12<00:10,  5.52it/s] 56%|█████▌    | 70/126 [00:12<00:10,  5.39it/s] 56%|█████▋    | 71/126 [00:12<00:10,  5.33it/s] 57%|█████▋    | 72/126 [00:12<00:10,  5.38it/s] 58%|█████▊    | 73/126 [00:12<00:09,  5.41it/s] 59%|█████▊    | 74/126 [00:13<00:09,  5.43it/s] 60%|█████▉    | 75/126 [00:13<00:09,  5.47it/s] 60%|██████    | 76/126 [00:13<00:09,  5.48it/s] 61%|██████    | 77/126 [00:13<00:08,  5.49it/s] 62%|██████▏   | 78/126 [00:13<00:08,  5.49it/s] 63%|██████▎   | 79/126 [00:14<00:08,  5.50it/s] 63%|██████▎   | 80/126 [00:14<00:08,  5.51it/s] 64%|██████▍   | 81/126 [00:14<00:08,  5.51it/s] 65%|██████▌   | 82/126 [00:14<00:07,  5.52it/s] 66%|██████▌   | 83/126 [00:14<00:07,  5.52it/s] 67%|██████▋   | 84/126 [00:14<00:07,  5.53it/s] 67%|██████▋   | 85/126 [00:15<00:07,  5.53it/s] 68%|██████▊   | 86/126 [00:15<00:07,  5.52it/s] 69%|██████▉   | 87/126 [00:15<00:07,  5.52it/s] 70%|██████▉   | 88/126 [00:15<00:06,  5.51it/s] 71%|███████   | 89/126 [00:15<00:06,  5.52it/s] 71%|███████▏  | 90/126 [00:16<00:06,  5.50it/s] 72%|███████▏  | 91/126 [00:16<00:06,  5.51it/s] 73%|███████▎  | 92/126 [00:16<00:06,  5.51it/s] 74%|███████▍  | 93/126 [00:16<00:05,  5.50it/s] 75%|███████▍  | 94/126 [00:16<00:05,  5.50it/s] 75%|███████▌  | 95/126 [00:16<00:05,  5.50it/s] 76%|███████▌  | 96/126 [00:17<00:05,  5.50it/s] 77%|███████▋  | 97/126 [00:17<00:05,  5.50it/s] 78%|███████▊  | 98/126 [00:17<00:05,  5.50it/s] 79%|███████▊  | 99/126 [00:17<00:04,  5.50it/s] 79%|███████▉  | 100/126 [00:17<00:04,  5.46it/s] 80%|████████  | 101/126 [00:18<00:04,  5.46it/s] 81%|████████  | 102/126 [00:18<00:04,  5.47it/s] 82%|████████▏ | 103/126 [00:18<00:04,  5.48it/s] 83%|████████▎ | 104/126 [00:18<00:04,  5.48it/s] 83%|████████▎ | 105/126 [00:18<00:03,  5.49it/s] 84%|████████▍ | 106/126 [00:18<00:03,  5.48it/s] 85%|████████▍ | 107/126 [00:19<00:03,  5.45it/s] 86%|████████▌ | 108/126 [00:19<00:03,  5.47it/s] 87%|████████▋ | 109/126 [00:19<00:03,  5.48it/s] 87%|████████▋ | 110/126 [00:19<00:02,  5.49it/s] 88%|████████▊ | 111/126 [00:19<00:02,  5.49it/s] 89%|████████▉ | 112/126 [00:20<00:02,  5.49it/s] 90%|████████▉ | 113/126 [00:20<00:02,  5.50it/s] 90%|█████████ | 114/126 [00:20<00:02,  5.49it/s] 91%|█████████▏| 115/126 [00:20<00:02,  5.49it/s] 92%|█████████▏| 116/126 [00:20<00:01,  5.50it/s] 93%|█████████▎| 117/126 [00:20<00:01,  5.50it/s] 94%|█████████▎| 118/126 [00:21<00:01,  5.49it/s] 94%|█████████▍| 119/126 [00:21<00:01,  5.49it/s] 95%|█████████▌| 120/126 [00:21<00:01,  5.46it/s] 96%|█████████▌| 121/126 [00:21<00:00,  5.45it/s] 97%|█████████▋| 122/126 [00:21<00:00,  5.45it/s] 98%|█████████▊| 123/126 [00:22<00:00,  5.45it/s] 98%|█████████▊| 124/126 [00:22<00:00,  5.41it/s] 99%|█████████▉| 125/126 [00:22<00:00,  5.41it/s]100%|██████████| 126/126 [00:22<00:00,  5.59it/s]
OOD (wp test) results: {'accuracy': 0.6710789210789211, 'precision': 0.7856547122602169, 'recall': 0.47052947052947053, 'f1': 0.5885660731021556, 'auroc': np.float64(0.7815881670776775)}
